

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>mastersign.datascience.plot &mdash; mastersign-datascience 0.1.8 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> mastersign-datascience
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../database.html">Database Access</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../plot.html">Plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../plot.html#module-mastersign.datascience.plot.basemap">Plotting with Basemap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notebook.html">Processing Jupyter Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cli.html">Command Line Interface</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">mastersign-datascience</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>mastersign.datascience.plot</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for mastersign.datascience.plot</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This module contains functionality to comfortably create plots.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">math</span> <span class="k">import</span> <span class="n">floor</span><span class="p">,</span> <span class="n">ceil</span><span class="p">,</span> <span class="n">pi</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="k">import</span> <span class="n">islice</span><span class="p">,</span> <span class="n">chain</span>
<span class="kn">from</span> <span class="nn">warnings</span> <span class="k">import</span> <span class="n">warn</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">interpolate</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.lines</span> <span class="k">as</span> <span class="nn">mlines</span>
<span class="kn">from</span> <span class="nn">configparser</span> <span class="k">import</span> <span class="n">ConfigParser</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">HTML</span><span class="p">,</span> <span class="n">display</span>
<span class="kn">from</span> <span class="nn">tabulate</span> <span class="k">import</span> <span class="n">tabulate</span>

<span class="n">_col_labels</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="s1">&#39;Anzahl&#39;</span>
<span class="p">}</span>


<div class="viewcode-block" id="spec_col_labels"><a class="viewcode-back" href="../../../plot.html#mastersign.datascience.plot.spec_col_labels">[docs]</a><span class="k">def</span> <span class="nf">spec_col_labels</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Specify labels for column names to be automatically used in plots.</span>

<span class="sd">    :param kwargs: A map of column names and labels.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_col_labels</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="spec_col_file"><a class="viewcode-back" href="../../../plot.html#mastersign.datascience.plot.spec_col_file">[docs]</a><span class="k">def</span> <span class="nf">spec_col_file</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Specify an INI file with column names to be automatically used in plots.</span>
<span class="sd">    The column-label-pairs must be placed under the INI section `[Columns]`.</span>

<span class="sd">    :param filename: A path to the INI file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cfg</span> <span class="o">=</span> <span class="n">ConfigParser</span><span class="p">()</span>
    <span class="n">cfg</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf8&#39;</span><span class="p">)</span>
    <span class="n">_col_labels</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="s1">&#39;Columns&#39;</span><span class="p">])</span></div>


<span class="k">def</span> <span class="nf">_col_label</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">column</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">label</span>
    <span class="k">if</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">_col_labels</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_col_labels</span><span class="p">[</span><span class="n">column</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">column</span>


<div class="viewcode-block" id="table"><a class="viewcode-back" href="../../../plot.html#mastersign.datascience.plot.table">[docs]</a><span class="k">def</span> <span class="nf">table</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
          <span class="n">with_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">index_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Displays an HTML table with the given data.</span>
<span class="sd">    A subset of columns can be selected with `columns`.</span>
<span class="sd">    The labels in the header can be explicitly specified with `labels`.</span>

<span class="sd">    Does not support multi-indexes.</span>

<span class="sd">    Calls `IPython.display.display()` to present the HTML table.</span>

<span class="sd">    :param data:        A Pandas DataFrame</span>
<span class="sd">    :param columns:     An iterable with column names. (optional)</span>
<span class="sd">    :param labels:      An iterable with column labels. (optional)</span>
<span class="sd">                        Must be the same size as the columns.</span>
<span class="sd">    :param with_index:  A switch to include or exclude the index. (optional)</span>
<span class="sd">    :param index_label: A string or an iterable with labels for the index.</span>
<span class="sd">                        (optional)</span>
<span class="sd">    :param limit:       A maximum number of rows to display. (optional)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="s1">&#39;&lt;p&gt;No Entries&lt;/p&gt;&#39;</span><span class="p">))</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="n">columns</span> <span class="ow">or</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span>
    <span class="k">if</span> <span class="n">labels</span><span class="p">:</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="n">labels</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="p">[</span><span class="n">_col_labels</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">_col_labels</span> <span class="k">else</span> <span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">with_index</span><span class="p">:</span>
        <span class="n">headers</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">index_label</span> <span class="ow">or</span> <span class="s1">&#39;index&#39;</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">cells</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">chain</span><span class="p">((</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">],),</span> <span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">def</span> <span class="nf">cells</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">)</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">cells</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">itertuples</span><span class="p">())</span>
    <span class="k">if</span> <span class="n">limit</span><span class="p">:</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="n">islice</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">limit</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s1">&#39;html&#39;</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)))</span></div>


<span class="n">current_figure</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">current_grid</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">allow_tight_layout</span> <span class="o">=</span> <span class="kc">True</span>


<div class="viewcode-block" id="begin"><a class="viewcode-back" href="../../../plot.html#mastersign.datascience.plot.begin">[docs]</a><span class="k">def</span> <span class="nf">begin</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Begins a figure with multiple subplots.</span>

<span class="sd">    :param figsize: A tuple with the figure size in inches (width, height).</span>
<span class="sd">                    (optional)</span>
<span class="sd">    :param grid:    The grid size to place the subplots in (rows, columns).</span>
<span class="sd">                    (optional)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">current_figure</span><span class="p">,</span> <span class="n">current_grid</span><span class="p">,</span> <span class="n">allow_tight_layout</span>
    <span class="k">if</span> <span class="n">current_figure</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">warn</span><span class="p">(</span><span class="s2">&quot;There is already an open figure. Did you use end()?&quot;</span><span class="p">)</span>
    <span class="n">current_figure</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
    <span class="n">current_grid</span> <span class="o">=</span> <span class="n">grid</span>
    <span class="n">allow_tight_layout</span> <span class="o">=</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="end"><a class="viewcode-back" href="../../../plot.html#mastersign.datascience.plot.end">[docs]</a><span class="k">def</span> <span class="nf">end</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">h_pad</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">file_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">file_dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Finalizes a figure with multiple subplots.</span>

<span class="sd">    :param pad:       Padding around the figure. (optional)</span>
<span class="sd">    :param w_pad:     Horizontal space between subplots. (optional)</span>
<span class="sd">                      See `matplotlib.pyplot.tight_layout()`.</span>
<span class="sd">    :param h_pad:     Vertical space between subplots. (optional)</span>
<span class="sd">                      See `matplotlib.pyplot.tight_layout()`.</span>
<span class="sd">    :param file_name: A path to a file to save the plot in. (optional)</span>
<span class="sd">    :param file_dpi:  A resolution to render the saved plot. (optional)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">current_figure</span><span class="p">,</span> <span class="n">allow_tight_layout</span>
    <span class="k">if</span> <span class="n">current_figure</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;No current figure. Did you use begin()?&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">allow_tight_layout</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">pad</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="n">pad</span><span class="p">,</span> <span class="n">h_pad</span><span class="o">=</span><span class="n">h_pad</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="n">w_pad</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">h_pad</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">w_pad</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">h_pad</span><span class="o">=</span><span class="n">h_pad</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="n">w_pad</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">pad</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">h_pad</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">w_pad</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># one reason can be a plot with colorbar, e.g. hist2d</span>
        <span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Padding can not be set because tight layout is suppressed.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">file_name</span><span class="p">:</span>
        <span class="n">current_figure</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">file_dpi</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">current_figure</span> <span class="o">=</span> <span class="kc">None</span></div>


<span class="k">def</span> <span class="nf">_in_multiplot</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">current_figure</span>
    <span class="k">return</span> <span class="n">current_figure</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>


<span class="k">def</span> <span class="nf">_plt</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">pos</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">current_figure</span><span class="p">,</span> <span class="n">current_grid</span>
    <span class="k">if</span> <span class="n">current_figure</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">(</span><span class="n">current_grid</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span>
                              <span class="n">rowspan</span><span class="o">=</span><span class="n">rowspan</span><span class="p">,</span> <span class="n">colspan</span><span class="o">=</span><span class="n">colspan</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">current_figure</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">())</span>


<div class="viewcode-block" id="subplot"><a class="viewcode-back" href="../../../plot.html#mastersign.datascience.plot.subplot">[docs]</a><span class="k">def</span> <span class="nf">subplot</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Prepares a sub-plot inside the current figure between calls</span>
<span class="sd">    of `begin()` and `end()`.</span>

<span class="sd">    This method is useful, if a custom plot must be integrated</span>
<span class="sd">    into a multiplot created with `mastersign.datasience.plot`.</span>

<span class="sd">    :param pos:     The position in the grid of a multiplot. (optional)</span>
<span class="sd">    :param rowspan: The number of rows to span in the grid</span>
<span class="sd">                    of a multiplot. (optional)</span>
<span class="sd">    :param colspan: The number of columns to span in the grid</span>
<span class="sd">                    of a multiplot. (optional)</span>
<span class="sd">    :return:        A tuple with Matplotlib figure and axes: ``(fig, ax)``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">_in_multiplot</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;No current figure. Did you use begin()?&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_plt</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">rowspan</span><span class="o">=</span><span class="n">rowspan</span><span class="p">,</span> <span class="n">colspan</span><span class="o">=</span><span class="n">colspan</span><span class="p">)</span></div>


<span class="k">def</span> <span class="nf">_suppress_tight_layout</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">allow_tight_layout</span>
    <span class="n">allow_tight_layout</span> <span class="o">=</span> <span class="kc">False</span>


<div class="viewcode-block" id="pie"><a class="viewcode-back" href="../../../plot.html#mastersign.datascience.plot.pie">[docs]</a><span class="k">def</span> <span class="nf">pie</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">label_column</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sort_by</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">pad</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">file_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">file_dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Display a pie chart with values from a column.</span>

<span class="sd">    :param data:         A Pandas DataFrame.</span>
<span class="sd">    :param column:       The column to use.</span>
<span class="sd">    :param label_column: A column to use for the labels.</span>
<span class="sd">                         By default the index is used.</span>
<span class="sd">    :param sort_by:      The sort mode `None`, `&quot;label&quot;`, or `&quot;value&quot;`</span>
<span class="sd">    :param title:        The title of the plot.</span>
<span class="sd">    :param pct:          A switch to display percentages.</span>
<span class="sd">    :param figsize:      The figure size in inches. (optional)</span>
<span class="sd">    :param pad:          Padding around the figure. (optional)</span>
<span class="sd">    :param pos:          The position in the grid of a multiplot. (optional)</span>
<span class="sd">    :param rowspan:      The number of rows to span in the grid</span>
<span class="sd">                         of a multiplot. (optional)</span>
<span class="sd">    :param colspan:      The number of columns to span in the grid</span>
<span class="sd">                         of a multiplot. (optional)</span>
<span class="sd">    :param file_name:    A path to a file to save the plot in. (optional)</span>
<span class="sd">    :param file_dpi:     A resolution to render the saved plot. (optional)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">sort_by</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">label_column</span><span class="p">)</span> \
            <span class="k">if</span> <span class="n">label_column</span> <span class="k">else</span> <span class="n">data</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">sort_by</span> <span class="o">==</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span>
        <span class="n">data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">column</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">column</span><span class="p">]</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">label_column</span><span class="p">]</span> <span class="k">if</span> <span class="n">label_column</span> <span class="k">else</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span>

    <span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span> <span class="o">=</span> <span class="n">_plt</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span>
                     <span class="n">rowspan</span><span class="o">=</span><span class="n">rowspan</span><span class="p">,</span> <span class="n">colspan</span><span class="o">=</span><span class="n">colspan</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">pct</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span>
                <span class="n">startangle</span><span class="o">=</span><span class="mi">180</span><span class="p">,</span> <span class="n">counterclock</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">autopct</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%1.1f%%</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span>
                <span class="n">startangle</span><span class="o">=</span><span class="mi">180</span><span class="p">,</span> <span class="n">counterclock</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">_in_multiplot</span><span class="p">()</span> <span class="ow">and</span> <span class="n">file_name</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">pad</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="n">pad</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">file_dpi</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">_in_multiplot</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">pad</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="n">pad</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="pie_groups"><a class="viewcode-back" href="../../../plot.html#mastersign.datascience.plot.pie_groups">[docs]</a><span class="k">def</span> <span class="nf">pie_groups</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">sort_by</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
               <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">pad</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
               <span class="n">file_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">file_dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Display a pie chart by counting rows according to a column value.</span>

<span class="sd">    :param data:      A Pandas DataFrame.</span>
<span class="sd">    :param column:    The column to use for grouping.</span>
<span class="sd">    :param sort_by:   The sort mode `None`, `&quot;label&quot;`, or `&quot;value&quot;`</span>
<span class="sd">    :param title:     The title of the plot.</span>
<span class="sd">    :param pct:       A switch to display percentages.</span>
<span class="sd">    :param figsize:   The figure size in inches. (optional)</span>
<span class="sd">    :param pad:       Padding around the figure. (optional)</span>
<span class="sd">    :param pos:       The position in the grid of a multiplot. (optional)</span>
<span class="sd">    :param rowspan:   The number of rows to span in the grid</span>
<span class="sd">                      of a multiplot. (optional)</span>
<span class="sd">    :param colspan:   The number of columns to span in the grid</span>
<span class="sd">                      of a multiplot. (optional)</span>
<span class="sd">    :param file_name: A path to a file to save the plot in. (optional)</span>
<span class="sd">    :param file_dpi:  A resolution to render the saved plot. (optional)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">groups</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
    <span class="n">group_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">groups</span><span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="n">groups</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
    <span class="n">pie</span><span class="p">(</span><span class="n">group_data</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">sort_by</span><span class="o">=</span><span class="n">sort_by</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="n">pct</span><span class="p">,</span>
        <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="n">pad</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">rowspan</span><span class="o">=</span><span class="n">rowspan</span><span class="p">,</span> <span class="n">colspan</span><span class="o">=</span><span class="n">colspan</span><span class="p">,</span>
        <span class="n">file_name</span><span class="o">=</span><span class="n">file_name</span><span class="p">,</span> <span class="n">file_dpi</span><span class="o">=</span><span class="n">file_dpi</span><span class="p">)</span></div>


<div class="viewcode-block" id="bar"><a class="viewcode-back" href="../../../plot.html#mastersign.datascience.plot.bar">[docs]</a><span class="k">def</span> <span class="nf">bar</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">value_column</span><span class="p">,</span> <span class="n">label_column</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">xlabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">pad</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">file_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">file_dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Display a bar chart from one two columns.</span>

<span class="sd">    :param data:         A Pandas DataFrame.</span>
<span class="sd">    :param value_column: The column with the values for the bars height.</span>
<span class="sd">    :param label_column: The column with the labels for the bars. (optional)</span>
<span class="sd">    :param xlabel:       The label for the X axis. (optional)</span>
<span class="sd">    :param ylabel:       The label for the Y axis. (optional)</span>
<span class="sd">    :param title:        The title of the plot. (optional)</span>
<span class="sd">    :param figsize:      The figure size in inches. (optional)</span>
<span class="sd">    :param pad:          Padding around the figure. (optional)</span>
<span class="sd">    :param pos:          The position in the grid of a multiplot. (optional)</span>
<span class="sd">    :param rowspan:      The number of rows to span in the grid</span>
<span class="sd">                         of a multiplot. (optional)</span>
<span class="sd">    :param colspan:      The number of columns to span in the grid</span>
<span class="sd">                         of a multiplot. (optional)</span>
<span class="sd">    :param file_name:    A path to a file to save the plot in. (optional)</span>
<span class="sd">    :param file_dpi:     A resolution to render the saved plot. (optional)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">label_column</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="n">label_column</span><span class="p">,</span> <span class="n">value_column</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">label_column</span><span class="p">]</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">value_column</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">value_column</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">index</span>

    <span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span> <span class="o">=</span> <span class="n">_plt</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span>
                     <span class="n">rowspan</span><span class="o">=</span><span class="n">rowspan</span><span class="p">,</span> <span class="n">colspan</span><span class="o">=</span><span class="n">colspan</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">_col_label</span><span class="p">(</span><span class="n">xlabel</span><span class="p">,</span> <span class="n">label_column</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">_col_label</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">value_column</span><span class="p">))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">_in_multiplot</span><span class="p">()</span> <span class="ow">and</span> <span class="n">file_name</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">pad</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="n">pad</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">file_dpi</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">_in_multiplot</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">pad</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="n">pad</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="hist"><a class="viewcode-back" href="../../../plot.html#mastersign.datascience.plot.hist">[docs]</a><span class="k">def</span> <span class="nf">hist</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">key_column</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
         <span class="n">bins</span><span class="o">=</span><span class="mi">35</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylog</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
         <span class="n">xlabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
         <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">pad</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
         <span class="n">file_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">file_dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Display a histogram for the values of one column.</span>
<span class="sd">    Optionally group the values by another key column.</span>

<span class="sd">    :param data:       A Pandas DataFrame.</span>
<span class="sd">    :param column:     The column to build the histogram of.</span>
<span class="sd">    :param key_column: The column to group the values by. (optional)</span>
<span class="sd">    :param bins:       The bins of the histogram (int or sequence or str).</span>
<span class="sd">                       (optional)</span>
<span class="sd">                       See argument `bins`  of `matplotlib.axes.Axes.hist()`</span>
<span class="sd">                       for more details.</span>
<span class="sd">    :param ticks:      A sequence of tick positions on the X axis. (optional)</span>
<span class="sd">    :param xmin:       The lower limit for displayed values (inclusive).</span>
<span class="sd">                       (optional)</span>
<span class="sd">    :param xmax:       The upper limit for displayed values (exclusive).</span>
<span class="sd">                       (optional)</span>
<span class="sd">    :param ylog:       A switch to use a logarithmic scale on the Y axis</span>
<span class="sd">                       (optional)</span>
<span class="sd">    :param xlabel:     The label for the X axis. (optional)</span>
<span class="sd">    :param ylabel:     The label for the Y axis. (optional)</span>
<span class="sd">    :param title:      The title of the plot. (optional)</span>
<span class="sd">    :param figsize:    The figure size in inches. (optional)</span>
<span class="sd">    :param pad:        Padding around the figure. (optional)</span>
<span class="sd">    :param pos:        The position in the grid of a multiplot. (optional)</span>
<span class="sd">    :param rowspan:    The number of rows to span in the grid</span>
<span class="sd">                       of a multiplot. (optional)</span>
<span class="sd">    :param colspan:    The number of columns to span in the grid</span>
<span class="sd">                       of a multiplot. (optional)</span>
<span class="sd">    :param file_name:  A path to a file to save the plot in. (optional)</span>
<span class="sd">    :param file_dpi:   A resolution to render the saved plot. (optional)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">prep_values</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">xmin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">s</span> <span class="o">&gt;=</span> <span class="n">xmin</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">xmax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">s</span> <span class="o">&lt;=</span> <span class="n">xmax</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">values</span>

    <span class="k">if</span> <span class="n">key_column</span><span class="p">:</span>
        <span class="n">grouped</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">key_column</span><span class="p">)</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">prep_values</span><span class="p">(</span><span class="n">grouped</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">column</span><span class="p">])</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">prep_values</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">column</span><span class="p">])</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">column</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">key_column</span><span class="p">:</span>
        <span class="n">columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key_column</span><span class="p">)</span>

    <span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span> <span class="o">=</span> <span class="n">_plt</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span>
                     <span class="n">rowspan</span><span class="o">=</span><span class="n">rowspan</span><span class="p">,</span> <span class="n">colspan</span><span class="o">=</span><span class="n">colspan</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="n">xmin</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">xmax</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ticks</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ylog</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">nonposy</span><span class="o">=</span><span class="s1">&#39;clip&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">_col_label</span><span class="p">(</span><span class="n">xlabel</span><span class="p">,</span> <span class="n">column</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">_col_label</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">key_column</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">_in_multiplot</span><span class="p">()</span> <span class="ow">and</span> <span class="n">file_name</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">pad</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="n">pad</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">file_dpi</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">_in_multiplot</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">pad</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="n">pad</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="hist2d"><a class="viewcode-back" href="../../../plot.html#mastersign.datascience.plot.hist2d">[docs]</a><span class="k">def</span> <span class="nf">hist2d</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">xcolumn</span><span class="p">,</span> <span class="n">ycolumn</span><span class="p">,</span>
           <span class="n">xmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
           <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
           <span class="n">xlabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
           <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">7.5</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">pad</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
           <span class="n">file_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">file_dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Displays a 2-dimensional histogram (heatmap).</span>

<span class="sd">    :param data:      A Pandas DataFrame.</span>
<span class="sd">    :param xcolumn:   The column for the horizontal dimension.</span>
<span class="sd">    :param ycolumn:   The column for the vertical dimension.</span>
<span class="sd">    :param xmin:      The lower limit for displayed values</span>
<span class="sd">                      in the horizontal dimension (inclusive). (optional)</span>
<span class="sd">    :param xmax:      The upper limit for displayed values</span>
<span class="sd">                      in the horizontal dimension (exclusive). (optional)</span>
<span class="sd">    :param ymin:      The lower limit for displayed values</span>
<span class="sd">                      in the vertical dimension (inclusive). (optional)</span>
<span class="sd">    :param ymax:      The upper limit for displayed values</span>
<span class="sd">                      in the vertical dimension (exclusive). (optional)</span>
<span class="sd">    :param cmap:      A Matplotlib Colormap or the name of a color map.</span>
<span class="sd">                      (optional)</span>
<span class="sd">                      See `matplotlib.pyplot.hist2d()` for more info.</span>
<span class="sd">    :param bins:      None or int or [int, int] or array_like or [array, array].</span>
<span class="sd">                      (optional)</span>
<span class="sd">                      See `matplotlib.pyplot.hist2d()` for more info.</span>
<span class="sd">    :param colorbar:  A switch to control if a colorbar is shown. (optional)</span>
<span class="sd">    :param xlabel:    A label for the X axis. (optional)</span>
<span class="sd">    :param ylabel:    A label for Y axis. (optional)</span>
<span class="sd">    :param title:     A title for the plot. (optional)</span>
<span class="sd">    :param figsize:   The figure size in inches. (optional)</span>
<span class="sd">    :param pad:        Padding around the figure. (optional)</span>
<span class="sd">    :param pos:       The position in the grid of a multiplot. (optional)</span>
<span class="sd">    :param rowspan:   The number of rows to span in the grid</span>
<span class="sd">                      of a multiplot. (optional)</span>
<span class="sd">    :param colspan:   The number of columns to span in the grid</span>
<span class="sd">                      of a multiplot. (optional)</span>
<span class="sd">    :param file_name: A path to a file to save the plot in. (optional)</span>
<span class="sd">    :param file_dpi:  A resolution to render the saved plot. (optional)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="n">xcolumn</span><span class="p">,</span> <span class="n">ycolumn</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">xmin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">xcolumn</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">xmin</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">xmax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">xcolumn</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">xmax</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">ymin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">ycolumn</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">ymin</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">ymax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">ycolumn</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">ymax</span><span class="p">]</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">xcolumn</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">ycolumn</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">empty</span> <span class="ow">or</span> <span class="n">y</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="n">xmin</span> <span class="o">=</span> <span class="n">xmin</span> <span class="k">if</span> <span class="n">xmin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">x</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
    <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax</span> <span class="k">if</span> <span class="n">xmax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
    <span class="n">ymin</span> <span class="o">=</span> <span class="n">ymin</span> <span class="k">if</span> <span class="n">ymin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">y</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
    <span class="n">ymax</span> <span class="o">=</span> <span class="n">ymax</span> <span class="k">if</span> <span class="n">ymax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">y</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
    <span class="n">r</span> <span class="o">=</span> <span class="p">[[</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">],</span> <span class="p">[</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">]]</span>

    <span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span> <span class="o">=</span> <span class="n">_plt</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span>
                     <span class="n">rowspan</span><span class="o">=</span><span class="n">rowspan</span><span class="p">,</span> <span class="n">colspan</span><span class="o">=</span><span class="n">colspan</span><span class="p">)</span>
    <span class="p">(</span><span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">image</span><span class="p">)</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">hist2d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="n">r</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">cmin</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">_col_label</span><span class="p">(</span><span class="n">xlabel</span><span class="p">,</span> <span class="n">xcolumn</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">_col_label</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">ycolumn</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">colorbar</span><span class="p">:</span>
        <span class="p">(</span><span class="n">cb_ax</span><span class="p">,</span> <span class="n">cb_kw</span><span class="p">)</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colorbar</span><span class="o">.</span><span class="n">make_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cb_ax</span><span class="p">,</span> <span class="o">**</span><span class="n">cb_kw</span><span class="p">)</span>
        <span class="n">_suppress_tight_layout</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">_in_multiplot</span><span class="p">()</span> <span class="ow">and</span> <span class="n">file_name</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">colorbar</span> <span class="ow">and</span> <span class="n">pad</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="n">pad</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">file_dpi</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">_in_multiplot</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">colorbar</span> <span class="ow">and</span> <span class="n">pad</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="n">pad</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="scatter"><a class="viewcode-back" href="../../../plot.html#mastersign.datascience.plot.scatter">[docs]</a><span class="k">def</span> <span class="nf">scatter</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">xcolumn</span><span class="p">,</span> <span class="n">ycolumn</span><span class="p">,</span>
            <span class="n">size_column</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color_column</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">xmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;rainbow&#39;</span><span class="p">,</span>
            <span class="n">xlabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">9.8</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">pad</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">file_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">file_dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Display a 2-dimensional scatter plot.</span>

<span class="sd">    :param data:         A Pandas DataFrame</span>
<span class="sd">    :param xcolumn:      The column for the horizontal dimension.</span>
<span class="sd">    :param ycolumn:      The column for the vertical dimension.</span>
<span class="sd">    :param size_column:  A column for the marker size. (optional)</span>
<span class="sd">    :param color_column: A column with values for the marker color. (optional)</span>
<span class="sd">    :param xmin:         The lower limit for displayed values</span>
<span class="sd">                         in the horizontal dimension. (optional)</span>
<span class="sd">    :param xmax:         The upper limit for displayed values</span>
<span class="sd">                         in the horizontal dimension. (optional)</span>
<span class="sd">    :param ymin:         The lower limit for displayed values</span>
<span class="sd">                         in the vertical dimension. (optional)</span>
<span class="sd">    :param ymax:         The upper limit for displayed values</span>
<span class="sd">                         in the vertical dimension. (optional)</span>
<span class="sd">    :param size:         A factor to the marker size. (optional)</span>
<span class="sd">    :param color:        A color for the markers. (optional)</span>
<span class="sd">                         Gets overridden by `color_column`.</span>
<span class="sd">    :param cmap:         A Matplotlib Colormap or the name of a color map.</span>
<span class="sd">                         Is used in combination with `color_column`. (optional)</span>
<span class="sd">                         See `matplotlib.pyplot.scatter()` for more info.</span>
<span class="sd">    :param xlabel:       A label for the X axis. (optional)</span>
<span class="sd">    :param ylabel:       A label for Y axis. (optional)</span>
<span class="sd">    :param title:        A title for the plot. (optional)</span>
<span class="sd">    :param figsize:      The figure size in inches. (optional)</span>
<span class="sd">    :param pad:          Padding around the figure. (optional)</span>
<span class="sd">    :param pos:          The position in the grid of a multiplot. (optional)</span>
<span class="sd">    :param rowspan:      The number of rows to span in the grid</span>
<span class="sd">                         of a multiplot. (optional)</span>
<span class="sd">    :param colspan:      The number of columns to span in the grid</span>
<span class="sd">                         of a multiplot. (optional)</span>
<span class="sd">    :param file_name:    A path to a file to save the plot in. (optional)</span>
<span class="sd">    :param file_dpi:     A resolution to render the saved plot. (optional)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">xcolumn</span><span class="p">,</span> <span class="n">ycolumn</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">size_column</span><span class="p">:</span>
        <span class="n">columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">size_column</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">color_column</span><span class="p">:</span>
        <span class="n">columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">color_column</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columns</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">xcolumn</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">ycolumn</span><span class="p">]</span>

    <span class="n">s</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">size_column</span><span class="p">]</span> <span class="k">if</span> <span class="n">size_column</span> <span class="k">else</span> <span class="mi">20</span><span class="p">)</span> <span class="o">*</span> <span class="n">size</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">color_column</span><span class="p">]</span> <span class="k">if</span> <span class="n">color_column</span> <span class="k">else</span> <span class="n">color</span>

    <span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span> <span class="o">=</span> <span class="n">_plt</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span>
                     <span class="n">rowspan</span><span class="o">=</span><span class="n">rowspan</span><span class="p">,</span> <span class="n">colspan</span><span class="o">=</span><span class="n">colspan</span><span class="p">)</span>
    <span class="n">marker</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="n">xmin</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">xmax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="n">ymin</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="n">ymax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">_col_label</span><span class="p">(</span><span class="n">xlabel</span><span class="p">,</span> <span class="n">xcolumn</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">_col_label</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">ycolumn</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">color_column</span><span class="p">:</span>
        <span class="p">(</span><span class="n">cb_ax</span><span class="p">,</span> <span class="n">cb_kw</span><span class="p">)</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colorbar</span><span class="o">.</span><span class="n">make_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">marker</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cb_ax</span><span class="p">,</span> <span class="o">**</span><span class="n">cb_kw</span><span class="p">)</span>
        <span class="n">_suppress_tight_layout</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">_in_multiplot</span><span class="p">()</span> <span class="ow">and</span> <span class="n">file_name</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">color_column</span> <span class="ow">and</span> <span class="n">pad</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="n">pad</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">file_dpi</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">_in_multiplot</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">color_column</span> <span class="ow">and</span> <span class="n">pad</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="n">pad</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="scatter_map"><a class="viewcode-back" href="../../../plot.html#mastersign.datascience.plot.scatter_map">[docs]</a><span class="k">def</span> <span class="nf">scatter_map</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                <span class="n">longitude_column</span><span class="o">=</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="n">latitude_column</span><span class="o">=</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span>
                <span class="n">region</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">autofit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;merc&#39;</span><span class="p">,</span>
                <span class="n">map_resolution</span><span class="o">=</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                <span class="n">map_style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">map_style_attributes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">size_column</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">size_mode</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">color_column</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;YlGnBu&#39;</span><span class="p">,</span>
                <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">pad</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">file_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">file_dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Displays a scatter plot on a geographical map.</span>

<span class="sd">    :param data:         A Pandas DataFrame.</span>
<span class="sd">    :param longitude_column:</span>
<span class="sd">                         The column with the longitudes. (optional)</span>
<span class="sd">    :param latitude_column:</span>
<span class="sd">                         The column with the latitudes. (optional)</span>
<span class="sd">    :param region:       The geographic region to plot. (optional)</span>
<span class="sd">                         A iterable with four elements:</span>
<span class="sd">                         lower left corner latitude,</span>
<span class="sd">                         lower left corner longitude,</span>
<span class="sd">                         upper right corner latitude,</span>
<span class="sd">                         and upper right corner longitude.</span>
<span class="sd">    :param autofit:      A switch to automatically zoom to a region,</span>
<span class="sd">                         showing all markers. (optional)</span>
<span class="sd">    :param grid:         A pair of distances for grid lines (lat, lon).</span>
<span class="sd">                         (optional)</span>
<span class="sd">    :param projection:   The named projection of the map.</span>
<span class="sd">                         See https://matplotlib.org/basemap/users/mapsetup.html</span>
<span class="sd">    :param map_style:    The name of a style. (optional)</span>
<span class="sd">    :param map_style_attributes:</span>
<span class="sd">                         A dict with style attributes. (optional)</span>
<span class="sd">    :param map_resolution:</span>
<span class="sd">                         The resolution of geographical and political features</span>
<span class="sd">                         on the map: crude `c`, low `l`, intermediate `i`,</span>
<span class="sd">                         high `h`, or full `f`. (optional)</span>
<span class="sd">    :param size_column:  A column with marker sizes. (optional)</span>
<span class="sd">    :param size:         A factor to the marker size. (optional)</span>
<span class="sd">    :param size_mode:    The mode for applying the size: `area` or `radius`.</span>
<span class="sd">                         (optional)</span>
<span class="sd">    :param color_column: A column with values for the marker color. (optional)</span>
<span class="sd">    :param color:        A color for the markers. (optional)</span>
<span class="sd">                         Gets overridden by `color_column`.</span>
<span class="sd">    :param cmap:         A Matplotlib Colormap or the name of a color map.</span>
<span class="sd">                         Is used in combination with `color_column`. (optional)</span>
<span class="sd">                         See `matplotlib.pyplot.scatter()` for more info.</span>
<span class="sd">    :param title:        A title for the plot. (optional)</span>
<span class="sd">    :param figsize:      The figure size in inches. (optional)</span>
<span class="sd">    :param pad:          Padding around the figure. (optional)</span>
<span class="sd">    :param pos:          The position in the grid of a multiplot. (optional)</span>
<span class="sd">    :param rowspan:      The number of rows to span in the grid</span>
<span class="sd">                         of a multiplot. (optional)</span>
<span class="sd">    :param colspan:      The number of columns to span in the grid</span>
<span class="sd">                         of a multiplot. (optional)</span>
<span class="sd">    :param file_name:    A path to a file to save the plot in. (optional)</span>
<span class="sd">    :param file_dpi:     A resolution to render the saved plot. (optional)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">from</span> <span class="nn">.basemap</span> <span class="k">import</span> <span class="n">base_map</span><span class="p">,</span> <span class="n">lat_lon_region</span>

    <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">longitude_column</span><span class="p">,</span> <span class="n">latitude_column</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">size_column</span><span class="p">:</span>
        <span class="n">columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">size_column</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">color_column</span><span class="p">:</span>
        <span class="n">columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">color_column</span><span class="p">)</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columns</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
    <span class="n">lon</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">longitude_column</span><span class="p">]</span>
    <span class="n">lat</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">latitude_column</span><span class="p">]</span>
    <span class="n">s</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">size_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="k">if</span> <span class="n">size_column</span> <span class="k">else</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">size</span>
    <span class="k">if</span> <span class="n">size_mode</span> <span class="o">==</span> <span class="s1">&#39;radius&#39;</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">pi</span>
    <span class="k">if</span> <span class="n">size_mode</span> <span class="o">==</span> <span class="s1">&#39;area&#39;</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">color_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="k">if</span> <span class="n">color_column</span> <span class="k">else</span> <span class="n">color</span>

    <span class="k">if</span> <span class="n">autofit</span> <span class="ow">or</span> <span class="n">region</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">region</span> <span class="o">=</span> <span class="p">[</span><span class="n">lat</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">lon</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">lat</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">lon</span><span class="o">.</span><span class="n">max</span><span class="p">()]</span>
        <span class="n">lat_margin</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">region</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">region</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mf">0.15</span>
        <span class="n">lon_margin</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">region</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">region</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="mf">0.15</span>
        <span class="n">region</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lat_margin</span>
        <span class="n">region</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lon_margin</span>
        <span class="n">region</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lat_margin</span>
        <span class="n">region</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lon_margin</span>
        <span class="k">if</span> <span class="n">region</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">region</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">180</span><span class="p">:</span>
            <span class="n">region</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">region</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">region</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">region</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span> <span class="o">=</span> <span class="n">_plt</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span>
                     <span class="n">rowspan</span><span class="o">=</span><span class="n">rowspan</span><span class="p">,</span> <span class="n">colspan</span><span class="o">=</span><span class="n">colspan</span><span class="p">)</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">base_map</span><span class="p">(</span><span class="n">lat_lon_region</span><span class="p">(</span><span class="o">*</span><span class="n">region</span><span class="p">),</span> <span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">,</span>
                 <span class="n">resolution</span><span class="o">=</span><span class="n">map_resolution</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span>
                 <span class="n">style_name</span><span class="o">=</span><span class="n">map_style</span><span class="p">,</span> <span class="n">style_attributes</span><span class="o">=</span><span class="n">map_style_attributes</span><span class="p">,</span>
                 <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">marker</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">lon</span><span class="o">.</span><span class="n">values</span><span class="p">),</span> <span class="nb">list</span><span class="p">(</span><span class="n">lat</span><span class="o">.</span><span class="n">values</span><span class="p">),</span> <span class="n">latlon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
              <span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">color_column</span><span class="p">:</span>
        <span class="p">(</span><span class="n">cb_ax</span><span class="p">,</span> <span class="n">cb_kw</span><span class="p">)</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colorbar</span><span class="o">.</span><span class="n">make_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">marker</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cb_ax</span><span class="p">,</span> <span class="o">**</span><span class="n">cb_kw</span><span class="p">)</span>
        <span class="n">_suppress_tight_layout</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">_in_multiplot</span><span class="p">()</span> <span class="ow">and</span> <span class="n">file_name</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">color_column</span> <span class="ow">and</span> <span class="n">pad</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="n">pad</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">file_dpi</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">_in_multiplot</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">color_column</span> <span class="ow">and</span> <span class="n">pad</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="n">pad</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<span class="k">def</span> <span class="nf">_moving_average</span><span class="p">(</span><span class="n">indices</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">window</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;indices and values do not have the same size&#39;</span><span class="p">)</span>

    <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">window</span><span class="p">)</span> <span class="o">/</span> <span class="n">window</span>  <span class="c1"># kernel</span>
    <span class="n">means</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="s1">&#39;valid&#39;</span><span class="p">)</span>

    <span class="n">start</span> <span class="o">=</span> <span class="n">floor</span><span class="p">(</span><span class="n">window</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span> <span class="o">-</span> <span class="n">ceil</span><span class="p">(</span><span class="n">window</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">sub_indices</span> <span class="o">=</span> <span class="n">indices</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">sub_indices</span><span class="p">,</span> <span class="n">means</span>


<span class="k">def</span> <span class="nf">_interpolate</span><span class="p">(</span><span class="n">indices</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">step</span><span class="p">,</span> <span class="n">kind</span><span class="p">):</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">kind</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">indices</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">step</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>


<div class="viewcode-block" id="lines"><a class="viewcode-back" href="../../../plot.html#mastersign.datascience.plot.lines">[docs]</a><span class="k">def</span> <span class="nf">lines</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">xcolumn</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
          <span class="n">key_column</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">min_n</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label_column</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
          <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
          <span class="n">avg_window</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">interpolation_step</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">interpolation_kind</span><span class="o">=</span><span class="s1">&#39;quadratic&#39;</span><span class="p">,</span>
          <span class="n">xmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
          <span class="n">xlabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
          <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">pad</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
          <span class="n">file_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">file_dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Display line(s) from values in one column of a DataFrame.</span>

<span class="sd">    :param data:         A Pandas DataFrame.</span>
<span class="sd">    :param column:       The column with the values to display as a line.</span>
<span class="sd">                         The values are used as vertical dimension.</span>
<span class="sd">    :param xcolumn:      A column with values for the horizontal dimension.</span>
<span class="sd">                         (optional)</span>
<span class="sd">    :param key_column:   A column for grouping without labels.</span>
<span class="sd">    :param label_column: A column for grouping with labels.</span>
<span class="sd">    :param min_n:        The minimum number of values, required in a group</span>
<span class="sd">                         for it to get drawn by a line. (optional)</span>
<span class="sd">    :param color:        A color for the line(s). (optional)</span>
<span class="sd">    :param linewidth:    The width of the line(s).</span>
<span class="sd">    :param avg_window:   The size of a window for smoothing the values</span>
<span class="sd">                         with a sliding average. (optional)</span>
<span class="sd">    :param interpolate_step:</span>
<span class="sd">                         A step size in the horizontal dimension,</span>
<span class="sd">                         for smoothing the line with interpolation.</span>
<span class="sd">    :param interpolate_kind:</span>
<span class="sd">                         The kind of interpolation to use:</span>
<span class="sd">                         `quadratic` or `cubic`. (optional)</span>
<span class="sd">                         Has an effect only if `interpolation_step` is used.</span>
<span class="sd">    :param xmin:         The lower limit for displayed values</span>
<span class="sd">                         in the horizontal dimension. (optional)</span>
<span class="sd">    :param xmax:         The upper limit for displayed values</span>
<span class="sd">                         in the horizontal dimension. (optional)</span>
<span class="sd">    :param ymin:         The lower limit for displayed values</span>
<span class="sd">                         in the vertical dimension. (optional)</span>
<span class="sd">    :param ymax:         The upper limit for displayed values</span>
<span class="sd">                         in the vertical dimension. (optional)</span>
<span class="sd">    :param xlabel:       A label for the X axis. (optional)</span>
<span class="sd">    :param ylabel:       A label for Y axis. (optional)</span>
<span class="sd">    :param title:        A title for the plot. (optional)</span>
<span class="sd">    :param figsize:      The figure size in inches. (optional)</span>
<span class="sd">    :param pad:          Padding around the figure. (optional)</span>
<span class="sd">    :param pos:          The position in the grid of a multiplot. (optional)</span>
<span class="sd">    :param rowspan:      The number of rows to span in the grid</span>
<span class="sd">                         of a multiplot. (optional)</span>
<span class="sd">    :param colspan:      The number of columns to span in the grid</span>
<span class="sd">                         of a multiplot. (optional)</span>
<span class="sd">    :param file_name:    A path to a file to save the plot in. (optional)</span>
<span class="sd">    :param file_dpi:     A resolution to render the saved plot. (optional)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span> <span class="o">=</span> <span class="n">_plt</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span>
                     <span class="n">rowspan</span><span class="o">=</span><span class="n">rowspan</span><span class="p">,</span> <span class="n">colspan</span><span class="o">=</span><span class="n">colspan</span><span class="p">)</span>
    <span class="n">legend_handles</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">columns</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="n">columns</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">xcolumn</span><span class="p">:</span>
        <span class="n">columns</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">xcolumn</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">label_column</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">key_column</span><span class="p">:</span>
        <span class="n">key_column</span> <span class="o">=</span> <span class="n">label_column</span>

    <span class="k">def</span> <span class="nf">plot_line</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">min_n</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">min_n</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">xcolumn</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="k">if</span> <span class="n">xcolumn</span> <span class="k">else</span> <span class="n">d</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="k">if</span> <span class="n">avg_window</span><span class="p">:</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">_moving_average</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">avg_window</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">interpolation_step</span><span class="p">:</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">_interpolate</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">interpolation_step</span><span class="p">,</span> <span class="n">interpolation_kind</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">l</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">key_column</span><span class="p">:</span>
        <span class="n">columns</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">key_column</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">label_column</span> <span class="ow">and</span> <span class="n">color</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">columns</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">label_column</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columns</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
            <span class="n">lgrouped</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">label_column</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">lgrouped</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="n">ldata</span> <span class="o">=</span> <span class="n">lgrouped</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
                <span class="n">color</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">_get_lines</span><span class="o">.</span><span class="n">prop_cycler</span><span class="p">)[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span>
                <span class="n">legend_handles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mlines</span><span class="o">.</span><span class="n">Line2D</span><span class="p">(</span>
                    <span class="p">[],</span> <span class="p">[],</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">))</span>
                <span class="n">grouped</span> <span class="o">=</span> <span class="n">ldata</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">key_column</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">grouped</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">plot_line</span><span class="p">(</span><span class="n">grouped</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columns</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
            <span class="n">grouped</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">key_column</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">grouped</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="n">plot_line</span><span class="p">(</span><span class="n">grouped</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="n">color</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columns</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
        <span class="n">plot_line</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="n">xmin</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">xmax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="n">ymin</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="n">ymax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">_col_label</span><span class="p">(</span><span class="n">xlabel</span><span class="p">,</span> <span class="n">xcolumn</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">_col_label</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">column</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">legend_handles</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">legend_handles</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">_in_multiplot</span><span class="p">()</span> <span class="ow">and</span> <span class="n">file_name</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">pad</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="n">pad</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">file_dpi</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">_in_multiplot</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">pad</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="n">pad</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="scatter_matrix"><a class="viewcode-back" href="../../../plot.html#mastersign.datascience.plot.scatter_matrix">[docs]</a><span class="k">def</span> <span class="nf">scatter_matrix</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">subplot_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                   <span class="n">file_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">file_dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots a matrix of scatter plots and histograms for a number of columns</span>
<span class="sd">    from a Pandas DataFrame.</span>

<span class="sd">    Warning: This function cannot be used between `begin()` and `end()` as part</span>
<span class="sd">    of another multiplot.</span>

<span class="sd">    :param data:         A Pandas DataFrame.</span>
<span class="sd">    :param columns:      The columns to include into the matrix. (optional)</span>
<span class="sd">    :param subplot_size: The edge length for the subplots. (optional)</span>
<span class="sd">    :param pad:          Padding around the figure. (optional)</span>
<span class="sd">    :param file_name:    A path to a file to save the plot in. (optional)</span>
<span class="sd">    :param file_dpi:     A resolution to render the saved plot. (optional)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">_in_multiplot</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;There is already an open figure. &quot;</span>
                        <span class="s2">&quot;You must use this function outside of a begin()-end()-block?&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">columns</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span>
    <span class="n">cn</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span>
    <span class="n">begin</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">cn</span><span class="p">,</span> <span class="n">cn</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">cn</span> <span class="o">*</span> <span class="n">subplot_size</span><span class="p">,</span> <span class="n">cn</span> <span class="o">*</span> <span class="n">subplot_size</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">iy</span><span class="p">,</span> <span class="n">cy</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">columns</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">cx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">columns</span><span class="p">):</span>
            <span class="n">ylabel</span> <span class="o">=</span> <span class="n">cy</span> <span class="k">if</span> <span class="n">ix</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
            <span class="n">xlabel</span> <span class="o">=</span> <span class="n">cx</span> <span class="k">if</span> <span class="n">iy</span> <span class="o">==</span> <span class="n">cn</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
            <span class="k">if</span> <span class="n">cy</span> <span class="o">!=</span> <span class="n">cx</span><span class="p">:</span>
                <span class="n">scatter</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xcolumn</span><span class="o">=</span><span class="n">cx</span><span class="p">,</span> <span class="n">ycolumn</span><span class="o">=</span><span class="n">cy</span><span class="p">,</span>
                        <span class="n">xlabel</span><span class="o">=</span><span class="n">xlabel</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="n">ylabel</span><span class="p">,</span>
                        <span class="n">pos</span><span class="o">=</span><span class="p">(</span><span class="n">iy</span><span class="p">,</span> <span class="n">ix</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cx</span><span class="p">,</span>
                     <span class="n">xlabel</span><span class="o">=</span><span class="n">xlabel</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="n">ylabel</span><span class="p">,</span>
                     <span class="n">pos</span><span class="o">=</span><span class="p">(</span><span class="n">iy</span><span class="p">,</span> <span class="n">ix</span><span class="p">))</span>

    <span class="n">end</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="n">pad</span><span class="p">,</span> <span class="n">h_pad</span><span class="o">=</span><span class="mf">1.75</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="n">file_name</span><span class="o">=</span><span class="n">file_name</span><span class="p">,</span> <span class="n">file_dpi</span><span class="o">=</span><span class="n">file_dpi</span><span class="p">)</span></div>


<div class="viewcode-block" id="hist2d_matrix"><a class="viewcode-back" href="../../../plot.html#mastersign.datascience.plot.hist2d_matrix">[docs]</a><span class="k">def</span> <span class="nf">hist2d_matrix</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">subplot_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">,</span>
                  <span class="n">file_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">file_dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots a matrix of 2D histogram plots and histograms for a number of columns</span>
<span class="sd">    from a Pandas DataFrame.</span>

<span class="sd">    Warning: This function cannot be used between `begin()` and `end()` as part</span>
<span class="sd">    of another multiplot.</span>

<span class="sd">    :param data:         A Pandas DataFrame.</span>
<span class="sd">    :param columns:      The columns to include into the matrix. (optional)</span>
<span class="sd">    :param subplot_size: The edge length for the subplots. (optional)</span>
<span class="sd">    :param pad:          Padding around the figure. (optional)</span>
<span class="sd">    :param cmap:         The color map to use. (optional)</span>
<span class="sd">    :param file_name:    A path to a file to save the plot in. (optional)</span>
<span class="sd">    :param file_dpi:     A resolution to render the saved plot. (optional)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">_in_multiplot</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;There is already an open figure. &quot;</span>
                        <span class="s2">&quot;You must use this function outside of a begin()-end()-block?&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">columns</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span>
    <span class="n">cn</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span>
    <span class="n">begin</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">cn</span><span class="p">,</span> <span class="n">cn</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">cn</span> <span class="o">*</span> <span class="n">subplot_size</span><span class="p">,</span> <span class="n">cn</span> <span class="o">*</span> <span class="n">subplot_size</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">iy</span><span class="p">,</span> <span class="n">cy</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">columns</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">cx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">columns</span><span class="p">):</span>
            <span class="n">ylabel</span> <span class="o">=</span> <span class="n">cy</span> <span class="k">if</span> <span class="n">ix</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
            <span class="n">xlabel</span> <span class="o">=</span> <span class="n">cx</span> <span class="k">if</span> <span class="n">iy</span> <span class="o">==</span> <span class="n">cn</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
            <span class="k">if</span> <span class="n">cy</span> <span class="o">!=</span> <span class="n">cx</span><span class="p">:</span>
                <span class="n">hist2d</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xcolumn</span><span class="o">=</span><span class="n">cx</span><span class="p">,</span> <span class="n">ycolumn</span><span class="o">=</span><span class="n">cy</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                       <span class="n">xlabel</span><span class="o">=</span><span class="n">xlabel</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                       <span class="n">pos</span><span class="o">=</span><span class="p">(</span><span class="n">iy</span><span class="p">,</span> <span class="n">ix</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cx</span><span class="p">,</span>
                     <span class="n">xlabel</span><span class="o">=</span><span class="n">xlabel</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="n">ylabel</span><span class="p">,</span>
                     <span class="n">pos</span><span class="o">=</span><span class="p">(</span><span class="n">iy</span><span class="p">,</span> <span class="n">ix</span><span class="p">))</span>

    <span class="n">end</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="n">pad</span><span class="p">,</span> <span class="n">h_pad</span><span class="o">=</span><span class="mf">1.75</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="n">file_name</span><span class="o">=</span><span class="n">file_name</span><span class="p">,</span> <span class="n">file_dpi</span><span class="o">=</span><span class="n">file_dpi</span><span class="p">)</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Tobias Kiertscher

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>